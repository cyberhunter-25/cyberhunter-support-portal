# CyberHunter Security Portal Environment Variables
# Copy this file to .env and fill in your values

# Flask Configuration
FLASK_APP=app
FLASK_ENV=development
FLASK_SECRET_KEY=your-secret-key-here-minimum-32-chars
FLASK_DEBUG=True

# Database Configuration
DATABASE_URL=postgresql://cyberhunter_user:your-password@localhost:5432/cyberhunter_portal
REDIS_URL=redis://localhost:6379/0

# OAuth Configuration - Microsoft
MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_TENANT_ID=common

# OAuth Configuration - Google
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Local Authentication
LOCAL_AUTH_ENABLED=True
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=True
PASSWORD_REQUIRE_LOWERCASE=True
PASSWORD_REQUIRE_NUMBERS=True
PASSWORD_REQUIRE_SPECIAL=True
PASSWORD_HISTORY_COUNT=5
ACCOUNT_LOCKOUT_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=1800  # 30 minutes in seconds

# MFA Configuration
MFA_ISSUER_NAME=CyberHunter Security Portal
MFA_BACKUP_CODES_COUNT=10
ADMIN_MFA_REQUIRED=True

# Email Configuration (Gmail)
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=True
SMTP_USERNAME=guardian@clirsec.com
SMTP_PASSWORD=your-app-specific-password
SMTP_DEFAULT_SENDER=CyberHunter Support <guardian@clirsec.com>

# IMAP Configuration (Gmail)
IMAP_SERVER=imap.gmail.com
IMAP_PORT=993
IMAP_USE_SSL=True
IMAP_USERNAME=guardian@clirsec.com
IMAP_PASSWORD=your-app-specific-password
IMAP_POLL_INTERVAL=60  # seconds

# Security Configuration
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax
PERMANENT_SESSION_LIFETIME=3600  # 1 hour
WTF_CSRF_TIME_LIMIT=None
MAX_CONTENT_LENGTH=104857600  # 100MB max request size

# File Upload Configuration
UPLOAD_FOLDER=/var/www/cyberhunter-portal/uploads
ALLOWED_EXTENSIONS=png,jpg,jpeg,gif,pdf,doc,docx,txt,log,csv,zip,7z
MAX_FILE_SIZE=26214400  # 25MB per file
CLAMAV_ENABLED=True
CLAMAV_SOCKET=/var/run/clamav/clamd.ctl

# Push Notifications (ntfy.sh)
NTFY_ENABLED=True
NTFY_SERVER=https://ntfy.sh
NTFY_TOPIC=cyberhunter-alerts
NTFY_PRIORITY_THRESHOLD=2  # Send notifications for priority 1 and 2

# Application URLs
APP_URL=https://support.cyberhunter.com
ADMIN_URL=https://support.cyberhunter.com/admin

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE=/var/log/cyberhunter-portal/app.log
AUDIT_LOG_FILE=/var/log/cyberhunter-portal/audit.log

# Celery Configuration
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=True

# Rate Limiting
RATELIMIT_ENABLED=True
RATELIMIT_STORAGE_URL=redis://localhost:6379/3
RATELIMIT_DEFAULT=100/hour
RATELIMIT_LOGIN=5/minute

# Monitoring
SENTRY_DSN=your-sentry-dsn-if-using
PROMETHEUS_ENABLED=False

# Company Configuration
COMPANY_LOGO_PATH=app/static/img/logo.png
COMPANY_NAME=CyberHunter CLIRSec
SUPPORT_PHONE=+1-XXX-XXX-XXXX
SUPPORT_EMAIL=support@cyberhunter.com

# Feature Flags
FEATURE_EMAIL_MONITORING=True
FEATURE_PUSH_NOTIFICATIONS=True
FEATURE_FILE_SCANNING=True
FEATURE_AUDIT_LOGGING=True